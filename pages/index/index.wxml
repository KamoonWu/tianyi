<view class="page-container">
  <view class="chart-section" wx:if="{{!hideChart}}">
    <view class="chart-controls">
      <button class="btn btn-outline" size="mini" bindtap="goSettings">设置</button>
      <button class="btn btn-secondary" size="mini" bindtap="showProfileSelector">命例</button>
      <button class="btn btn-primary" size="mini" bindtap="testChart">测试</button>
    </view>
    <zwds-chart 
      id="zwds-chart"
      palaces="{{chart.palaces}}"
      center="{{chart.center}}"
      flowYear="{{flowYear}}"
      bind:palaceClick="onPalaceClick">
    </zwds-chart>
  </view>
  
  <!-- 当隐藏图表时显示占位内容 -->
  <view class="chart-section" wx:if="{{hideChart}}">
    <view class="chart-controls">
      <button class="btn btn-outline" size="mini" bindtap="goSettings">设置</button>
      <button class="btn btn-secondary" size="mini" bindtap="showProfileSelector">命例</button>
      <button class="btn btn-primary" size="mini" bindtap="testChart">测试</button>
    </view>
    <view class="chart-placeholder">
      <text>正在加载命例选择器...</text>
    </view>
  </view>
</view>

<!-- 底部弹出的命例选择器 - 只有点击"命例"按钮时才显示 -->
<view class="profile-selector-overlay {{showSelector ? 'show' : ''}}" wx:if="{{showSelector}}" catchtap="hideProfileSelector"></view>
<view class="profile-selector-bottom {{showSelector ? 'show' : ''}}" wx:if="{{showSelector}}">
  <view class="selector-header">
    <view class="selector-title">选择命例</view>
    <view class="selector-close" catchtap="hideProfileSelector">×</view>
  </view>
  <scroll-view class="profile-list" scroll-y="true">
    <view 
      wx:for="{{profiles}}" 
      wx:key="id" 
      class="profile-item {{currentProfileIndex === index ? 'active' : ''}}"
      data-index="{{index}}"
      bindtap="selectProfile">
      <view class="profile-main">
        <view class="profile-name">{{item.name}}</view>
        <view class="profile-desc">{{item.description}}</view>
      </view>
      <view class="profile-check" wx:if="{{currentProfileIndex === index}}">✓</view>
    </view>
  </scroll-view>
</view>
